"use strict";(globalThis.webpackChunkhumanoid_robotics_course=globalThis.webpackChunkhumanoid_robotics_course||[]).push([[367],{8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var s=r(6540);const t={},a=s.createContext(t);function o(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:n},e.children)}},8634:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>m});const s=JSON.parse('{"id":"capstone-the-autonomous-humanoid/capstone-practical-lab","title":"Capstone \u2014 The Autonomous Humanoid | Chapter 4 \u2014 Practical Lab","description":"Capstone Integration: Building the Autonomous Humanoid","source":"@site/docs/capstone-the-autonomous-humanoid/capstone-practical-lab.md","sourceDirName":"capstone-the-autonomous-humanoid","slug":"/capstone-the-autonomous-humanoid/capstone-practical-lab","permalink":"/humanoid-robotics-course/docs/capstone-the-autonomous-humanoid/capstone-practical-lab","draft":false,"unlisted":false,"editUrl":"https://github.com/RizSheik/humanoid-robotics-course/edit/main/docs/capstone-the-autonomous-humanoid/capstone-practical-lab.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"capstone-practical-lab","title":"Capstone \u2014 The Autonomous Humanoid | Chapter 4 \u2014 Practical Lab","sidebar_label":"Chapter 4 \u2014 Practical Lab","sidebar_position":4},"sidebar":"textbookSidebar","previous":{"title":"Chapter 3 \u2014 Deep-Dive Theory","permalink":"/humanoid-robotics-course/docs/capstone-the-autonomous-humanoid/capstone-deep-dive"},"next":{"title":"Chapter 5 \u2014 Simulation","permalink":"/humanoid-robotics-course/docs/capstone-the-autonomous-humanoid/capstone-simulation"}}');var t=r(4848),a=r(8453);const o={id:"capstone-practical-lab",title:"Capstone \u2014 The Autonomous Humanoid | Chapter 4 \u2014 Practical Lab",sidebar_label:"Chapter 4 \u2014 Practical Lab",sidebar_position:4},i="Chapter 4 \u2014 Practical Lab",l={},m=[{value:"Capstone Integration: Building the Autonomous Humanoid",id:"capstone-integration-building-the-autonomous-humanoid",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Lab 1: System Architecture Implementation",id:"lab-1-system-architecture-implementation",level:2},{value:"Creating the Integration Framework",id:"creating-the-integration-framework",level:3},{value:"Lab 2: Subsystem Status Monitoring",id:"lab-2-subsystem-status-monitoring",level:2},{value:"Creating a System Status Dashboard",id:"creating-a-system-status-dashboard",level:3},{value:"Lab 3: Command and Control Interface",id:"lab-3-command-and-control-interface",level:2},{value:"Creating a High-Level Command Interface",id:"creating-a-high-level-command-interface",level:3},{value:"Lab 4: Creating a Launch File for Integrated System",id:"lab-4-creating-a-launch-file-for-integrated-system",level:2},{value:"Creating a Comprehensive Launch File",id:"creating-a-comprehensive-launch-file",level:3},{value:"Lab 5: Performance Monitoring and Diagnostics",id:"lab-5-performance-monitoring-and-diagnostics",level:2},{value:"Creating a Performance Monitoring Node",id:"creating-a-performance-monitoring-node",level:3},{value:"Lab 6: Testing the Integrated System",id:"lab-6-testing-the-integrated-system",level:2},{value:"Creating a Basic Integration Test",id:"creating-a-basic-integration-test",level:3},{value:"Lab 7: Building and Running the Integrated System",id:"lab-7-building-and-running-the-integrated-system",level:2},{value:"Final Steps to Build and Test",id:"final-steps-to-build-and-test",level:3},{value:"Summary",id:"summary",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"chapter-4--practical-lab",children:"Chapter 4 \u2014 Practical Lab"})}),"\n",(0,t.jsx)(n.h2,{id:"capstone-integration-building-the-autonomous-humanoid",children:"Capstone Integration: Building the Autonomous Humanoid"}),"\n",(0,t.jsx)(n.p,{children:"In this practical lab, we'll integrate all components developed in previous modules into a unified autonomous humanoid system. This will involve connecting the ROS 2 nervous system, digital twin simulation, AI-robot brain, and vision-language-action systems into a cohesive architecture that demonstrates advanced autonomous capabilities."}),"\n",(0,t.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"Before starting this lab, ensure you have:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Completed all previous modules (Modules 1-4)"}),"\n",(0,t.jsx)(n.li,{children:"NVIDIA GPU with CUDA support (RTX 4090 or equivalent recommended)"}),"\n",(0,t.jsx)(n.li,{children:"Ubuntu 22.04 with ROS 2 Humble"}),"\n",(0,t.jsx)(n.li,{children:"All Isaac ROS packages installed"}),"\n",(0,t.jsx)(n.li,{children:"Isaac Sim and Isaac Lab installed"}),"\n",(0,t.jsx)(n.li,{children:"Access to a humanoid robot model or simulation environment"}),"\n",(0,t.jsx)(n.li,{children:"All packages from previous modules properly built"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"lab-1-system-architecture-implementation",children:"Lab 1: System Architecture Implementation"}),"\n",(0,t.jsx)(n.h3,{id:"creating-the-integration-framework",children:"Creating the Integration Framework"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create the main integration package"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\r\nros2 pkg create --build-type ament_python integration_pkg --dependencies rclpy sensor_msgs geometry_msgs std_msgs nav_msgs visualization_msgs tf2_ros tf2_geometry_msgs message_filters\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create the central integration node"})," (",(0,t.jsx)(n.code,{children:"~/ros2_ws/src/integration_pkg/integration_pkg/autonomous_humanoid.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n"""\r\nMain integration node for the autonomous humanoid system\r\n"""\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import Image, LaserScan, Imu, JointState\r\nfrom geometry_msgs.msg import Twist, PoseStamped, PointStamped\r\nfrom std_msgs.msg import String, Bool, Float32\r\nfrom nav_msgs.msg import Odometry, Path\r\nfrom geometry_msgs.msg import PoseWithCovarianceStamped\r\nimport threading\r\nimport time\r\nimport numpy as np\r\nfrom collections import deque\r\n\r\nclass AutonomousHumanoidNode(Node):\r\n    def __init__(self):\r\n        super().__init__(\'autonomous_humanoid\')\r\n        \r\n        # System state\r\n        self.system_state = \'idle\'  # idle, active, emergency_stop\r\n        self.emergency_stop_active = False\r\n        \r\n        # Subsystem states\r\n        self.perception_ready = False\r\n        self.ai_brain_ready = False\r\n        self.vla_ready = False\r\n        self.navigation_ready = False\r\n        \r\n        # Data storage\r\n        self.robot_pose = None\r\n        self.odom_data = None\r\n        self.camera_data = None\r\n        self.laser_data = None\r\n        self.joint_states = None\r\n        self.imu_data = None\r\n        \r\n        # Integration state\r\n        self.current_task = None\r\n        self.task_queue = deque()\r\n        self.last_command_time = time.time()\r\n        \r\n        # Publishers\r\n        self.cmd_vel_pub = self.create_publisher(Twist, \'/cmd_vel\', 10)\r\n        self.joint_cmd_pub = self.create_publisher(JointState, \'/joint_commands\', 10)\r\n        self.goal_pub = self.create_publisher(PoseStamped, \'/goal_pose\', 10)\r\n        self.status_pub = self.create_publisher(String, \'/system_status\', 10)\r\n        self.emergency_stop_pub = self.create_publisher(Bool, \'/emergency_stop\', 10)\r\n        \r\n        # Subscribers\r\n        self.odom_sub = self.create_subscription(Odometry, \'/odom\', self.odom_callback, 10)\r\n        self.imu_sub = self.create_subscription(Imu, \'/imu\', self.imu_callback, 10)\r\n        self.joint_sub = self.create_subscription(JointState, \'/joint_states\', self.joint_callback, 10)\r\n        self.laser_sub = self.create_subscription(LaserScan, \'/scan\', self.laser_callback, 10)\r\n        \r\n        # Subscribers for subsystem outputs\r\n        self.perception_sub = self.create_subscription(String, \'/perception/status\', self.perception_status_callback, 10)\r\n        self.ai_brain_sub = self.create_subscription(String, \'/ai_brain/status\', self.ai_brain_status_callback, 10)\r\n        self.vla_sub = self.create_subscription(String, \'/vla/status\', self.vla_status_callback, 10)\r\n        self.navigation_sub = self.create_subscription(String, \'/navigation/status\', self.navigation_status_callback, 10)\r\n        \r\n        # Subscribers for high-level commands\r\n        self.command_sub = self.create_subscription(String, \'/command\', self.command_callback, 10)\r\n        \r\n        # Timer for system monitoring\r\n        self.monitor_timer = self.create_timer(0.1, self.system_monitor)\r\n        \r\n        # Safety timer\r\n        self.safety_timer = self.create_timer(0.05, self.safety_check)\r\n        \r\n        # Control loop timer\r\n        self.control_timer = self.create_timer(0.02, self.control_loop)\r\n        \r\n        self.get_logger().info(\'Autonomous Humanoid Integration Node started\')\r\n\r\n    def odom_callback(self, msg):\r\n        """Handle odometry data"""\r\n        self.odom_data = msg\r\n        self.robot_pose = msg.pose.pose\r\n\r\n    def imu_callback(self, msg):\r\n        """Handle IMU data"""\r\n        self.imu_data = msg\r\n\r\n    def joint_callback(self, msg):\r\n        """Handle joint state data"""\r\n        self.joint_states = msg\r\n\r\n    def laser_callback(self, msg):\r\n        """Handle laser scan data"""\r\n        self.laser_data = msg\r\n\r\n    def perception_status_callback(self, msg):\r\n        """Handle perception system status"""\r\n        if msg.data == "ready":\r\n            self.perception_ready = True\r\n        elif msg.data == "not_ready":\r\n            self.perception_ready = False\r\n        self.get_logger().info(f\'Perception status: {msg.data}\')\r\n\r\n    def ai_brain_status_callback(self, msg):\r\n        """Handle AI brain system status"""\r\n        if msg.data == "ready":\r\n            self.ai_brain_ready = True\r\n        elif msg.data == "not_ready":\r\n            self.ai_brain_ready = False\r\n        self.get_logger().info(f\'AI Brain status: {msg.data}\')\r\n\r\n    def vla_status_callback(self, msg):\r\n        """Handle VLA system status"""\r\n        if msg.data == "ready":\r\n            self.vla_ready = True\r\n        elif msg.data == "not_ready":\r\n            self.vla_ready = False\r\n        self.get_logger().info(f\'VLA status: {msg.data}\')\r\n\r\n    def navigation_status_callback(self, msg):\r\n        """Handle navigation system status"""\r\n        if msg.data == "ready":\r\n            self.navigation_ready = True\r\n        elif msg.data == "not_ready":\r\n            self.navigation_ready = False\r\n        self.get_logger().info(f\'Navigation status: {msg.data}\')\r\n\r\n    def command_callback(self, msg):\r\n        """Handle high-level commands"""\r\n        command = msg.data.lower()\r\n        \r\n        if command.startswith(\'navigate to\'):\r\n            # Extract destination from command\r\n            destination = command.replace(\'navigate to\', \'\').strip()\r\n            self.get_logger().info(f\'Received navigation command: {destination}\')\r\n            \r\n            # In a real system, this would be more sophisticated\r\n            # For now, we\'ll just navigate to a predefined location\r\n            self.queue_navigation_task(destination)\r\n            \r\n        elif command == \'emergency stop\':\r\n            self.activate_emergency_stop()\r\n            \r\n        elif command == \'resume\':\r\n            self.deactivate_emergency_stop()\r\n            \r\n        else:\r\n            self.get_logger().info(f\'Unknown command: {command}\')\r\n\r\n    def queue_navigation_task(self, destination):\r\n        """Queue a navigation task"""\r\n        task = {\r\n            \'type\': \'navigation\',\r\n            \'destination\': destination,\r\n            \'status\': \'pending\'\r\n        }\r\n        self.task_queue.append(task)\r\n        self.get_logger().info(f\'Queued navigation task to: {destination}\')\r\n\r\n    def activate_emergency_stop(self):\r\n        """Activate emergency stop"""\r\n        self.emergency_stop_active = True\r\n        self.system_state = \'emergency_stop\'\r\n        self.get_logger().warn(\'EMERGENCY STOP ACTIVATED\')\r\n        \r\n        # Send stop command to all actuators\r\n        stop_cmd = Twist()\r\n        self.cmd_vel_pub.publish(stop_cmd)\r\n        \r\n        # Publish emergency stop message\r\n        emergency_msg = Bool()\r\n        emergency_msg.data = True\r\n        self.emergency_stop_pub.publish(emergency_msg)\r\n\r\n    def deactivate_emergency_stop(self):\r\n        """Deactivate emergency stop"""\r\n        self.emergency_stop_active = False\r\n        self.system_state = \'idle\'\r\n        self.get_logger().info(\'Emergency stop deactivated\')\r\n\r\n    def system_monitor(self):\r\n        """Monitor the overall system status"""\r\n        ready_subsystems = sum([\r\n            self.perception_ready,\r\n            self.ai_brain_ready,\r\n            self.vla_ready,\r\n            self.navigation_ready\r\n        ])\r\n        \r\n        status_msg = String()\r\n        status_msg.data = f"State: {self.system_state} | Ready subsystems: {ready_subsystems}/4 | Tasks: {len(self.task_queue)}"\r\n        self.status_pub.publish(status_msg)\r\n        \r\n        # Log system status periodically\r\n        if int(time.time()) % 5 == 0:  # Log every 5 seconds\r\n            self.get_logger().info(f"System Status - State: {self.system_state}, Subsystems Ready: {ready_subsystems}/4")\r\n\r\n    def safety_check(self):\r\n        """Perform safety checks"""\r\n        if self.emergency_stop_active:\r\n            # Already in emergency stop state, ensure safety\r\n            stop_cmd = Twist()\r\n            self.cmd_vel_pub.publish(stop_cmd)\r\n            return\r\n        \r\n        # Check for safety violations\r\n        if self.laser_data:\r\n            # Check for obstacles in front of robot\r\n            front_scans = self.laser_data.ranges[:10] + self.laser_data.ranges[-10:]\r\n            min_distance = min([d for d in front_scans if not np.isnan(d)], default=float(\'inf\'))\r\n            \r\n            if 0 < min_distance < 0.3:  # Obstacle within 30cm\r\n                self.get_logger().warn(f\'Safety violation: Obstacle at {min_distance:.2f}m\')\r\n                # Implement safety response\r\n                self.activate_emergency_stop()\r\n\r\n    def control_loop(self):\r\n        """Main control loop"""\r\n        if self.emergency_stop_active:\r\n            return\r\n            \r\n        if self.task_queue and self.system_state != \'active\':\r\n            # Process next task in queue\r\n            task = self.task_queue.popleft()\r\n            self.current_task = task\r\n            self.system_state = \'active\'\r\n            \r\n            if task[\'type\'] == \'navigation\':\r\n                self.execute_navigation_task(task)\r\n                \r\n        elif not self.task_queue:\r\n            # No tasks, return to idle\r\n            self.system_state = \'idle\'\r\n            self.current_task = None\r\n\r\n    def execute_navigation_task(self, task):\r\n        """Execute a navigation task"""\r\n        destination = task[\'destination\']\r\n        self.get_logger().info(f\'Executing navigation to: {destination}\')\r\n        \r\n        # In a real system, this would send a goal to the navigation stack\r\n        # For this example, we\'ll just move forward for demonstration\r\n        cmd_vel = Twist()\r\n        cmd_vel.linear.x = 0.2  # Move forward at 0.2 m/s\r\n        self.cmd_vel_pub.publish(cmd_vel)\r\n        \r\n        # Simulate task completion after 10 seconds\r\n        def complete_task():\r\n            time.sleep(10)\r\n            if self.current_task == task:\r\n                self.current_task = None\r\n                self.system_state = \'idle\'\r\n                self.get_logger().info(\'Navigation task completed\')\r\n        \r\n        task_thread = threading.Thread(target=complete_task, daemon=True)\r\n        task_thread.start()\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = AutonomousHumanoidNode()\r\n    \r\n    try:\r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        node.get_logger().info(\'Shutting down autonomous humanoid system\')\r\n    finally:\r\n        # Ensure safety on shutdown\r\n        stop_cmd = Twist()\r\n        node.cmd_vel_pub.publish(stop_cmd)\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Update the setup.py file"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\r\nimport os\r\nfrom glob import glob\r\n\r\npackage_name = 'integration_pkg'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=[package_name],\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='your_name',\r\n    maintainer_email='your_email@example.com',\r\n    description='Integration package for autonomous humanoid system',\r\n    license='MIT',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'autonomous_humanoid = integration_pkg.autonomous_humanoid:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Build the integration package"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select integration_pkg\r\nsource ~/ros2_ws/install/setup.bash\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lab-2-subsystem-status-monitoring",children:"Lab 2: Subsystem Status Monitoring"}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-system-status-dashboard",children:"Creating a System Status Dashboard"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create a system status node"})," (",(0,t.jsx)(n.code,{children:"~/ros2_ws/src/integration_pkg/integration_pkg/system_status.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n\"\"\"\r\nSystem status monitoring node for the autonomous humanoid\r\n\"\"\"\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String, Bool, Float32\r\nfrom sensor_msgs.msg import JointState\r\nfrom nav_msgs.msg import Odometry\r\nfrom visualization_msgs.msg import Marker, MarkerArray\r\nfrom geometry_msgs.msg import Point\r\nimport time\r\nimport threading\r\n\r\nclass SystemStatusNode(Node):\r\n    def __init__(self):\r\n        super().__init__('system_status')\r\n        \r\n        # System status storage\r\n        self.subsystem_statuses = {\r\n            'perception': {'status': 'unknown', 'last_update': 0},\r\n            'ai_brain': {'status': 'unknown', 'last_update': 0},\r\n            'vla': {'status': 'unknown', 'last_update': 0},\r\n            'navigation': {'status': 'unknown', 'last_update': 0}\r\n        }\r\n        \r\n        self.emergency_stop_active = False\r\n        self.robot_pose = None\r\n        self.joint_states = None\r\n        self.last_command_time = time.time()\r\n        \r\n        # Publishers\r\n        self.status_viz_pub = self.create_publisher(MarkerArray, '/system_status_viz', 10)\r\n        self.performance_pub = self.create_publisher(String, '/performance_summary', 10)\r\n        \r\n        # Subscribers\r\n        self.perception_sub = self.create_subscription(String, '/perception/status', self.perception_status_callback, 10)\r\n        self.ai_brain_sub = self.create_subscription(String, '/ai_brain/status', self.ai_brain_status_callback, 10)\r\n        self.vla_sub = self.create_subscription(String, '/vla/status', self.vla_status_callback, 10)\r\n        self.navigation_sub = self.create_subscription(String, '/navigation/status', self.navigation_status_callback, 10)\r\n        self.emergency_stop_sub = self.create_subscription(Bool, '/emergency_stop', self.emergency_stop_callback, 10)\r\n        self.odom_sub = self.create_subscription(Odometry, '/odom', self.odom_callback, 10)\r\n        self.joint_sub = self.create_subscription(JointState, '/joint_states', self.joint_callback, 10)\r\n        \r\n        # Timer for status visualization\r\n        self.viz_timer = self.create_timer(1.0, self.publish_status_viz)\r\n        \r\n        # Timer for performance summary\r\n        self.perf_timer = self.create_timer(5.0, self.publish_performance_summary)\r\n        \r\n        self.get_logger().info('System Status Node started')\r\n\r\n    def perception_status_callback(self, msg):\r\n        self.subsystem_statuses['perception']['status'] = msg.data\r\n        self.subsystem_statuses['perception']['last_update'] = time.time()\r\n\r\n    def ai_brain_status_callback(self, msg):\r\n        self.subsystem_statuses['ai_brain']['status'] = msg.data\r\n        self.subsystem_statuses['ai_brain']['last_update'] = time.time()\r\n\r\n    def vla_status_callback(self, msg):\r\n        self.subsystem_statuses['vla']['status'] = msg.data\r\n        self.subsystem_statuses['vla']['last_update'] = time.time()\r\n\r\n    def navigation_status_callback(self, msg):\r\n        self.subsystem_statuses['navigation']['status'] = msg.data\r\n        self.subsystem_statuses['navigation']['last_update'] = time.time()\r\n\r\n    def emergency_stop_callback(self, msg):\r\n        self.emergency_stop_active = msg.data\r\n\r\n    def odom_callback(self, msg):\r\n        self.robot_pose = msg.pose.pose\r\n\r\n    def joint_callback(self, msg):\r\n        self.joint_states = msg\r\n\r\n    def publish_status_viz(self):\r\n        \"\"\"Publish visualization markers for system status\"\"\"\r\n        marker_array = MarkerArray()\r\n        \r\n        # Create a text marker for each subsystem\r\n        y_offset = 0\r\n        for i, (subsystem, status_info) in enumerate(self.subsystem_statuses.items()):\r\n            marker = Marker()\r\n            marker.header.frame_id = \"map\"  # Use appropriate frame\r\n            marker.header.stamp = self.get_clock().now().to_msg()\r\n            marker.ns = \"system_status\"\r\n            marker.id = i\r\n            marker.type = Marker.TEXT_VIEW_FACING\r\n            marker.action = Marker.ADD\r\n            \r\n            # Position markers in a column\r\n            marker.pose.position.x = -2.0\r\n            marker.pose.position.y = y_offset\r\n            marker.pose.position.z = 1.0\r\n            marker.pose.orientation.w = 1.0\r\n            \r\n            marker.scale.z = 0.2  # Text size\r\n            \r\n            # Color based on status\r\n            if status_info['status'] == 'ready':\r\n                marker.color.r = 0.0\r\n                marker.color.g = 1.0\r\n                marker.color.b = 0.0\r\n                marker.color.a = 1.0\r\n            elif status_info['status'] == 'not_ready':\r\n                marker.color.r = 1.0\r\n                marker.color.g = 0.0\r\n                marker.color.b = 0.0\r\n                marker.color.a = 1.0\r\n            else:\r\n                marker.color.r = 1.0\r\n                marker.color.g = 1.0\r\n                marker.color.b = 0.0\r\n                marker.color.a = 1.0\r\n            \r\n            marker.text = f\"{subsystem}: {status_info['status']}\"\r\n            marker_array.markers.append(marker)\r\n            \r\n            y_offset -= 0.3  # Space between markers\r\n        \r\n        # Add emergency stop indicator\r\n        em_marker = Marker()\r\n        em_marker.header.frame_id = \"map\"\r\n        em_marker.header.stamp = self.get_clock().now().to_msg()\r\n        em_marker.ns = \"system_status\"\r\n        em_marker.id = len(self.subsystem_statuses)\r\n        em_marker.type = Marker.TEXT_VIEW_FACING\r\n        em_marker.action = Marker.ADD\r\n        \r\n        em_marker.pose.position.x = -2.0\r\n        em_marker.pose.position.y = y_offset\r\n        em_marker.pose.position.z = 1.0\r\n        em_marker.pose.orientation.w = 1.0\r\n        \r\n        em_marker.scale.z = 0.2\r\n        em_marker.color.r = 1.0 if self.emergency_stop_active else 0.5\r\n        em_marker.color.g = 0.0 if self.emergency_stop_active else 0.5\r\n        em_marker.color.b = 0.0 if self.emergency_stop_active else 0.5\r\n        em_marker.color.a = 1.0\r\n        \r\n        em_marker.text = f\"EMERGENCY: {'ACTIVE' if self.emergency_stop_active else 'INACTIVE'}\"\r\n        marker_array.markers.append(em_marker)\r\n        \r\n        self.status_viz_pub.publish(marker_array)\r\n\r\n    def publish_performance_summary(self):\r\n        \"\"\"Publish performance summary\"\"\"\r\n        summary_msg = String()\r\n        \r\n        # Calculate subsystem health\r\n        ready_count = sum(1 for status in self.subsystem_statuses.values() \r\n                         if status['status'] == 'ready')\r\n        total_count = len(self.subsystem_statuses)\r\n        \r\n        # Calculate system uptime\r\n        uptime_minutes = int(time.time() / 60)\r\n        \r\n        summary_msg.data = (f\"System Health: {ready_count}/{total_count} subsystems ready, \"\r\n                           f\"Uptime: {uptime_minutes} min, \"\r\n                           f\"Emergency: {'ACTIVE' if self.emergency_stop_active else 'OK'}\")\r\n        \r\n        self.performance_pub.publish(summary_msg)\r\n        self.get_logger().info(summary_msg.data)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = SystemStatusNode()\r\n    \r\n    try:\r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lab-3-command-and-control-interface",children:"Lab 3: Command and Control Interface"}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-high-level-command-interface",children:"Creating a High-Level Command Interface"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create a command interface node"})," (",(0,t.jsx)(n.code,{children:"~/ros2_ws/src/integration_pkg/integration_pkg/command_interface.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n\"\"\"\r\nCommand interface for the autonomous humanoid system\r\n\"\"\"\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String, Bool\r\nimport time\r\n\r\nclass CommandInterfaceNode(Node):\r\n    def __init__(self):\r\n        super().__init__('command_interface')\r\n        \r\n        # Publishers\r\n        self.command_pub = self.create_publisher(String, '/command', 10)\r\n        self.status_sub = self.create_subscription(String, '/system_status', self.status_callback, 10)\r\n        \r\n        # Store recent status\r\n        self.last_status = \"Unknown\"\r\n        \r\n        self.get_logger().info('Command Interface Node started')\r\n        self.get_logger().info('Ready to accept commands. Type \"help\" for command list.')\r\n\r\n    def status_callback(self, msg):\r\n        \"\"\"Store the latest system status\"\"\"\r\n        self.last_status = msg.data\r\n\r\n    def process_command(self, command):\r\n        \"\"\"Process and send a command to the humanoid system\"\"\"\r\n        if command.lower() in ['quit', 'exit']:\r\n            self.get_logger().info('Command interface shutting down...')\r\n            return False\r\n            \r\n        elif command.lower() == 'help':\r\n            self.show_help()\r\n            \r\n        elif command.lower() == 'status':\r\n            self.get_logger().info(f'Current system status: {self.last_status}')\r\n            \r\n        elif command.lower().startswith('navigate to '):\r\n            # Process navigation command\r\n            destination = command[12:]  # Remove 'navigate to ' prefix\r\n            if destination.strip():\r\n                cmd_msg = String()\r\n                cmd_msg.data = command.lower()\r\n                self.command_pub.publish(cmd_msg)\r\n                self.get_logger().info(f'Sent navigation command: {command}')\r\n            else:\r\n                self.get_logger().warn('Please specify a destination for navigation.')\r\n                \r\n        elif command.lower() == 'emergency stop':\r\n            cmd_msg = String()\r\n            cmd_msg.data = 'emergency stop'\r\n            self.command_pub.publish(cmd_msg)\r\n            self.get_logger().warn('Sent emergency stop command!')\r\n            \r\n        elif command.lower() == 'resume':\r\n            cmd_msg = String()\r\n            cmd_msg.data = 'resume'\r\n            self.command_pub.publish(cmd_msg)\r\n            self.get_logger().info('Sent resume command.')\r\n            \r\n        else:\r\n            self.get_logger().warn(f'Unknown command: {command}. Type \"help\" for command list.')\r\n            \r\n        return True\r\n\r\n    def show_help(self):\r\n        \"\"\"Display available commands\"\"\"\r\n        help_text = \"\"\"\r\nAvailable Commands:\r\n  navigate to [location] - Navigate to specified location\r\n  emergency stop         - Activate emergency stop\r\n  resume                 - Resume operation after emergency stop\r\n  status                 - Show current system status\r\n  help                   - Show this help message\r\n  quit/exit              - Exit the command interface\r\n        \"\"\"\r\n        self.get_logger().info(help_text)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = CommandInterfaceNode()\r\n    \r\n    try:\r\n        # Run command loop in a separate thread to allow ROS spinning\r\n        import threading\r\n        command_thread = threading.Thread(target=command_loop, args=(node,), daemon=True)\r\n        command_thread.start()\r\n        \r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        node.get_logger().info('Shutting down command interface')\r\n    finally:\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\ndef command_loop(node):\r\n    \"\"\"Command input loop\"\"\"\r\n    while rclpy.ok():\r\n        try:\r\n            command = input(\"Enter command: \").strip()\r\n            if not node.process_command(command):\r\n                break\r\n        except EOFError:\r\n            break\r\n        except Exception as e:\r\n            node.get_logger().error(f'Error processing command: {e}')\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lab-4-creating-a-launch-file-for-integrated-system",children:"Lab 4: Creating a Launch File for Integrated System"}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-comprehensive-launch-file",children:"Creating a Comprehensive Launch File"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create a launch directory and file"})," (",(0,t.jsx)(n.code,{children:"~/ros2_ws/src/integration_pkg/launch/integrated_humanoid.launch.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import os\r\nfrom launch import LaunchDescription\r\nfrom launch.actions import DeclareLaunchArgument, RegisterEventHandler, LogInfo\r\nfrom launch.event_handlers import OnProcessStart, OnProcessIO\r\nfrom launch.substitutions import LaunchConfiguration\r\nfrom launch_ros.actions import Node\r\nfrom ament_index_python.packages import get_package_share_directory\r\n\r\ndef generate_launch_description():\r\n    # Declare launch arguments\r\n    use_sim_time = LaunchConfiguration('use_sim_time', default='true')\r\n    enable_dashboard = LaunchConfiguration('enable_dashboard', default='true')\r\n    \r\n    # Main integration node\r\n    autonomous_humanoid_node = Node(\r\n        package='integration_pkg',\r\n        executable='autonomous_humanoid',\r\n        name='autonomous_humanoid',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen'\r\n    )\r\n    \r\n    # System status node\r\n    system_status_node = Node(\r\n        package='integration_pkg',\r\n        executable='system_status',\r\n        name='system_status',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen'\r\n    )\r\n    \r\n    # Command interface node (only if needed for interactive use)\r\n    command_interface_node = Node(\r\n        package='integration_pkg',\r\n        executable='command_interface',\r\n        name='command_interface',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen',\r\n        condition=launch.conditions.IfCondition(enable_dashboard)\r\n    )\r\n    \r\n    # Placeholder for perception system (would be real perception package in actual implementation)\r\n    perception_node = Node(\r\n        package='dummy_perception_pkg',  # Replace with real perception package\r\n        executable='perception_node',\r\n        name='perception_node',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen'\r\n    )\r\n    \r\n    # Placeholder for AI brain (would be real AI package in actual implementation)\r\n    ai_brain_node = Node(\r\n        package='dummy_ai_pkg',  # Replace with real AI package\r\n        executable='ai_brain_node',\r\n        name='ai_brain_node',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen'\r\n    )\r\n    \r\n    # Placeholder for VLA system (would be real VLA package in actual implementation)\r\n    vla_node = Node(\r\n        package='dummy_vla_pkg',  # Replace with real VLA package\r\n        executable='vla_node',\r\n        name='vla_node',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen'\r\n    )\r\n    \r\n    # Placeholder for navigation system (would be real navigation package in actual implementation)\r\n    navigation_node = Node(\r\n        package='nav2_bringup',  # Using nav2 as example\r\n        executable='navigation_node',\r\n        name='navigation_node',\r\n        parameters=[\r\n            {'use_sim_time': use_sim_time}\r\n        ],\r\n        output='screen'\r\n    )\r\n    \r\n    # Return the launch description\r\n    return LaunchDescription([\r\n        DeclareLaunchArgument(\r\n            'use_sim_time',\r\n            default_value='true',\r\n            description='Use simulation (Gazebo) clock if true'\r\n        ),\r\n        DeclareLaunchArgument(\r\n            'enable_dashboard',\r\n            default_value='true',\r\n            description='Enable command dashboard interface'\r\n        ),\r\n        autonomous_humanoid_node,\r\n        system_status_node,\r\n        command_interface_node,\r\n        # These would be connected to real subsystem implementations:\r\n        # perception_node,\r\n        # ai_brain_node,\r\n        # vla_node,\r\n        # navigation_node,\r\n    ])\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lab-5-performance-monitoring-and-diagnostics",children:"Lab 5: Performance Monitoring and Diagnostics"}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-performance-monitoring-node",children:"Creating a Performance Monitoring Node"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create a performance monitoring node"})," (",(0,t.jsx)(n.code,{children:"~/ros2_ws/src/integration_pkg/integration_pkg/performance_monitor.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n"""\r\nPerformance monitoring for the autonomous humanoid system\r\n"""\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String, Float32, Int32\r\nfrom sensor_msgs.msg import Image, LaserScan\r\nimport time\r\nfrom collections import deque\r\nimport threading\r\n\r\nclass PerformanceMonitorNode(Node):\r\n    def __init__(self):\r\n        super().__init__(\'performance_monitor\')\r\n        \r\n        # Performance metrics\r\n        self.fps_metrics = {\r\n            \'camera\': deque(maxlen=100),\r\n            \'laser\': deque(maxlen=100),\r\n            \'control\': deque(maxlen=100)\r\n        }\r\n        self.latency_metrics = {\r\n            \'perception_to_action\': deque(maxlen=50),\r\n            \'command_response\': deque(maxlen=50)\r\n        }\r\n        self.cpu_usage = deque(maxlen=100)\r\n        self.memory_usage = deque(maxlen=100)\r\n        \r\n        # Timestamp tracking\r\n        self.last_camera_time = None\r\n        self.last_laser_time = None\r\n        self.last_command_time = None\r\n        \r\n        # Publishers\r\n        self.fps_pub = self.create_publisher(Float32, \'/performance/fps\', 10)\r\n        self.latency_pub = self.create_publisher(Float32, \'/performance/latency\', 10)\r\n        self.status_pub = self.create_publisher(String, \'/performance/status\', 10)\r\n        \r\n        # Subscribers for timing\r\n        self.camera_sub = self.create_subscription(Image, \'/camera/image_raw\', self.camera_callback, 1)\r\n        self.laser_sub = self.create_subscription(LaserScan, \'/scan\', self.laser_callback, 1)\r\n        self.command_sub = self.create_subscription(String, \'/command\', self.command_callback, 10)\r\n        \r\n        # Timer for publishing metrics\r\n        self.metrics_timer = self.create_timer(1.0, self.publish_metrics)\r\n        self.status_timer = self.create_timer(2.0, self.publish_status)\r\n        \r\n        # Start system resource monitoring\r\n        self.resource_thread = threading.Thread(target=self.monitor_resources, daemon=True)\r\n        self.resource_thread.start()\r\n        \r\n        self.get_logger().info(\'Performance Monitor Node started\')\r\n\r\n    def camera_callback(self, msg):\r\n        """Handle camera message timing"""\r\n        if self.last_camera_time:\r\n            dt = msg.header.stamp.sec + msg.header.stamp.nanosec * 1e-9 - \\\r\n                 (self.last_camera_time.sec + self.last_camera_time.nanosec * 1e-9)\r\n            fps = 1.0 / dt if dt > 0 else 0\r\n            self.fps_metrics[\'camera\'].append(fps)\r\n        self.last_camera_time = msg.header.stamp\r\n\r\n    def laser_callback(self, msg):\r\n        """Handle laser scan message timing"""\r\n        if self.last_laser_time:\r\n            dt = msg.header.stamp.sec + msg.header.stamp.nanosec * 1e-9 - \\\r\n                 (self.last_laser_time.sec + self.last_laser_time.nanosec * 1e-9)\r\n            fps = 1.0 / dt if dt > 0 else 0\r\n            self.fps_metrics[\'laser\'].append(fps)\r\n        self.last_laser_time = msg.header.stamp\r\n\r\n    def command_callback(self, msg):\r\n        """Handle command timing"""\r\n        if self.last_command_time:\r\n            current_time = self.get_clock().now().nanoseconds * 1e-9\r\n            last_time = self.last_command_time.sec + self.last_command_time.nanosec * 1e-9\r\n            latency = current_time - last_time\r\n            self.latency_metrics[\'command_response\'].append(latency)\r\n        self.last_command_time = self.get_clock().now().to_msg()\r\n\r\n    def monitor_resources(self):\r\n        """Monitor CPU and memory usage"""\r\n        import psutil\r\n        \r\n        while rclpy.ok():\r\n            cpu_percent = psutil.cpu_percent(interval=1)\r\n            memory_percent = psutil.virtual_memory().percent\r\n            \r\n            self.cpu_usage.append(cpu_percent)\r\n            self.memory_usage.append(memory_percent)\r\n\r\n    def publish_metrics(self):\r\n        """Publish performance metrics"""\r\n        # Average FPS for camera\r\n        if self.fps_metrics[\'camera\']:\r\n            avg_camera_fps = sum(self.fps_metrics[\'camera\']) / len(self.fps_metrics[\'camera\'])\r\n            fps_msg = Float32()\r\n            fps_msg.data = avg_camera_fps\r\n            self.fps_pub.publish(fps_msg)\r\n\r\n    def publish_status(self):\r\n        """Publish system performance status"""\r\n        status_parts = []\r\n        \r\n        # FPS status\r\n        if self.fps_metrics[\'camera\']:\r\n            avg_camera_fps = sum(self.fps_metrics[\'camera\']) / len(self.fps_metrics[\'camera\'])\r\n            status_parts.append(f"Camera FPS: {avg_camera_fps:.1f}")\r\n        \r\n        # Latency status\r\n        if self.latency_metrics[\'command_response\']:\r\n            avg_latency = sum(self.latency_metrics[\'command_response\']) / len(self.latency_metrics[\'command_response\'])\r\n            status_parts.append(f"Command Latency: {avg_latency:.3f}s")\r\n        \r\n        # Resource usage\r\n        if self.cpu_usage:\r\n            avg_cpu = sum(self.cpu_usage) / len(self.cpu_usage)\r\n            status_parts.append(f"CPU: {avg_cpu:.1f}%")\r\n        \r\n        if self.memory_usage:\r\n            avg_memory = sum(self.memory_usage) / len(self.memory_usage)\r\n            status_parts.append(f"Memory: {avg_memory:.1f}%")\r\n        \r\n        status_msg = String()\r\n        status_msg.data = " | ".join(status_parts)\r\n        self.status_pub.publish(status_msg)\r\n        \r\n        self.get_logger().info(f"Performance: {status_msg.data}")\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = PerformanceMonitorNode()\r\n    \r\n    try:\r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,t.jsx)(n.h2,{id:"lab-6-testing-the-integrated-system",children:"Lab 6: Testing the Integrated System"}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-basic-integration-test",children:"Creating a Basic Integration Test"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create an integration test script"})," (",(0,t.jsx)(n.code,{children:"~/ros2_ws/src/integration_pkg/integration_pkg/integration_test.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n\"\"\"\r\nIntegration test for the autonomous humanoid system\r\n\"\"\"\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String, Bool\r\nfrom geometry_msgs.msg import Twist\r\nfrom sensor_msgs.msg import JointState\r\nimport time\r\n\r\nclass IntegrationTestNode(Node):\r\n    def __init__(self):\r\n        super().__init__('integration_test')\r\n        \r\n        # Publishers for sending test commands\r\n        self.command_pub = self.create_publisher(String, '/command', 10)\r\n        self.cmd_vel_pub = self.create_publisher(Twist, '/cmd_vel', 10)\r\n        \r\n        # Subscribers for monitoring system responses\r\n        self.status_sub = self.create_subscription(String, '/system_status', self.status_callback, 10)\r\n        self.emergency_sub = self.create_subscription(Bool, '/emergency_stop', self.emergency_callback, 10)\r\n        \r\n        # Test state\r\n        self.test_phase = 0\r\n        self.test_results = {}\r\n        self.system_ready = False\r\n        self.emergency_triggered = False\r\n        \r\n        # Start test sequence\r\n        self.test_timer = self.create_timer(2.0, self.run_test_sequence)\r\n        \r\n        self.get_logger().info('Integration Test Node started')\r\n\r\n    def status_callback(self, msg):\r\n        \"\"\"Monitor system status\"\"\"\r\n        if \"Ready subsystems: 4/4\" in msg.data:\r\n            self.system_ready = True\r\n            self.get_logger().info('All subsystems are ready')\r\n\r\n    def emergency_callback(self, msg):\r\n        \"\"\"Detect emergency stop\"\"\"\r\n        if msg.data:\r\n            self.emergency_triggered = True\r\n            self.get_logger().warn('Emergency stop was triggered during test')\r\n\r\n    def run_test_sequence(self):\r\n        \"\"\"Run the integration test sequence\"\"\"\r\n        if self.test_phase == 0:\r\n            self.get_logger().info('Test Phase 0: Verifying system readiness')\r\n            if self.system_ready:\r\n                self.test_results['system_readiness'] = True\r\n                self.test_phase = 1\r\n                self.get_logger().info('System readiness verified, moving to next phase')\r\n            else:\r\n                self.test_results['system_readiness'] = False\r\n                self.get_logger().warn('System not ready, continuing anyway')\r\n                self.test_phase = 1\r\n                \r\n        elif self.test_phase == 1:\r\n            self.get_logger().info('Test Phase 1: Sending navigation command')\r\n            cmd_msg = String()\r\n            cmd_msg.data = 'navigate to kitchen'\r\n            self.command_pub.publish(cmd_msg)\r\n            self.test_results['navigation_command'] = True\r\n            self.test_phase = 2\r\n            \r\n        elif self.test_phase == 2:\r\n            self.get_logger.info('Test Phase 2: Monitoring navigation execution')\r\n            # Check if emergency was triggered during navigation\r\n            self.test_results['navigation_safety'] = not self.emergency_triggered\r\n            self.test_phase = 3\r\n            \r\n        elif self.test_phase == 3:\r\n            self.get_logger.info('Test Phase 3: Testing emergency stop')\r\n            # Trigger emergency stop\r\n            cmd_msg = String()\r\n            cmd_msg.data = 'emergency stop'\r\n            self.command_pub.publish(cmd_msg)\r\n            self.test_results['emergency_triggered'] = True\r\n            self.test_phase = 4\r\n            \r\n        elif self.test_phase == 4:\r\n            self.get_logger.info('Test Phase 4: Verifying emergency stop response')\r\n            self.test_results['emergency_response'] = self.emergency_triggered\r\n            self.test_phase = 5\r\n            \r\n        elif self.test_phase == 5:\r\n            self.get_logger.info('Test Phase 5: Resuming after emergency')\r\n            cmd_msg = String()\r\n            cmd_msg.data = 'resume'\r\n            self.command_pub.publish(cmd_msg)\r\n            self.test_phase = 6\r\n            \r\n        elif self.test_phase == 6:\r\n            self.get_logger().info('Test Phase 6: Final system check')\r\n            # Wait a bit and check final status\r\n            self.test_results['final_state'] = True\r\n            self.test_phase = 7\r\n            self.report_test_results()\r\n            \r\n        elif self.test_phase == 7:\r\n            # Test complete, stop timer\r\n            self.test_timer.cancel()\r\n\r\n    def report_test_results(self):\r\n        \"\"\"Report the results of the integration test\"\"\"\r\n        self.get_logger().info('--- INTEGRATION TEST RESULTS ---')\r\n        for test, result in self.test_results.items():\r\n            status = 'PASS' if result else 'FAIL'\r\n            self.get_logger().info(f'{test}: {status}')\r\n        \r\n        # Overall result\r\n        all_passed = all(self.test_results.values())\r\n        overall = 'PASS' if all_passed else 'FAIL'\r\n        self.get_logger().info(f'Overall Integration Test: {overall}')\r\n        self.get_logger().info('--- END TEST RESULTS ---')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = IntegrationTestNode()\r\n    \r\n    try:\r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        node.get_logger().info('Integration test interrupted')\r\n    finally:\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lab-7-building-and-running-the-integrated-system",children:"Lab 7: Building and Running the Integrated System"}),"\n",(0,t.jsx)(n.h3,{id:"final-steps-to-build-and-test",children:"Final Steps to Build and Test"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Update the setup.py to include all new executables"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\r\nimport os\r\nfrom glob import glob\r\n\r\npackage_name = 'integration_pkg'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=[package_name],\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n        ('share/' + package_name + '/launch', glob('launch/*.launch.py')),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='your_name',\r\n    maintainer_email='your_email@example.com',\r\n    description='Integration package for autonomous humanoid system',\r\n    license='MIT',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'autonomous_humanoid = integration_pkg.autonomous_humanoid:main',\r\n            'system_status = integration_pkg.system_status:main',\r\n            'command_interface = integration_pkg.command_interface:main',\r\n            'performance_monitor = integration_pkg.performance_monitor:main',\r\n            'integration_test = integration_pkg.integration_test:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Build the complete integration package"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select integration_pkg\r\nsource ~/ros2_ws/install/setup.bash\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create a simple test launch file to test individual components"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Terminal 1 - Start the main integration node\r\nsource ~/ros2_ws/install/setup.bash\r\nros2 run integration_pkg autonomous_humanoid\r\n\r\n# Terminal 2 - Start the system status monitor\r\nsource ~/ros2_ws/install/setup.bash\r\nros2 run integration_pkg system_status\r\n\r\n# Terminal 3 - Start the command interface\r\nsource ~/ros2_ws/install/setup.bash\r\nros2 run integration_pkg command_interface\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run the integration test"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run integration test after starting the system\r\nsource ~/ros2_ws/install/setup.bash\r\nros2 run integration_pkg integration_test\n"})}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"In this practical lab, we've created a comprehensive integration framework for the autonomous humanoid system. We developed:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Main Integration Node"}),": The central hub that coordinates all subsystems and manages the overall system state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"System Status Monitoring"}),": Real-time visualization and monitoring of subsystem statuses"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Command Interface"}),": Human-friendly interface for controlling the robot"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance Monitoring"}),": Metrics collection for system performance and health"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Integration Testing"}),": Automated testing framework to validate the integration"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This integration framework demonstrates the key challenges of connecting multiple complex robotic subsystems:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Communication coordination"}),": Ensuring all subsystems can communicate effectively"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Timing synchronization"}),": Managing different update rates across subsystems"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Safety integration"}),": Implementing safety checks across all components"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance optimization"}),": Monitoring and optimizing system performance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"State management"}),": Tracking the state of complex integrated systems"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The framework provides a solid foundation for connecting the ROS 2 nervous system, digital twin, AI brain, and VLA systems into a unified autonomous humanoid platform. Each component can be extended and customized based on specific requirements and available subsystem implementations."})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);